[%
import "PackageCreation.egl";
 
var modelProject := Model.allInstances().first();
var packages : Set;
// packages := currentPackages();

// Saca los paquetes directamente del modelo mejor
packages := modelProject.packagedElement.select(p|p.isTypeOf(Package));

// Aquí deberías crear directamente un proyecto Visual C# con toda su pesca.
// Lo puedes hacer más adelante. Puedes utilizar algún tipo de API de Visual 
// Studio

// Directories
for (pack in packages) {
    // Yo aquí crearía un directorio por cada paquete, aunque el paquete no
    // tuviese nada    	 
	for (class in pack.packagedElement.select(e|e.isTypeOf(Class))) { 
  		var t := TemplateFactory.load('ClassCreation.egl');
		t.populate ('currentClass', class);	
		t.populate('currentPackage', pack);
		t.populate('currentModel', modelProject);
    	t.generate ('../'+modelProject.name+'/' + pack.name + '/'+ class.name +'.cs');    	
     }
}
%] 
