%%==================================================================%%
%% Author : Pérez Ruiz, Alejandro                                   %%
%% Author : Sánchez Barreiro, Pablo                                 %%
%% Version: 1.1, 14/06/2011                                         %%
%%                                                                  %%
%% Memoria del Proyecto Fin de Carrera                              %%
%% Domain Engineering/Interacion Dos                                %%
%%==================================================================%%

La característica de gestión de los sistemas de control de la temperatura  (\emph{HeaterMng}) deberá  permitir a los usuarios establecer el valor deseado para la temperatura (en grados Celsius). Los dispositivos de control de la temperatura funcionan como aparatos de frío/calor. De esta forma, si la temperatura especificada por el usuario es inferior a la actual, el dispositivo deberá enfriar la casa. En el caso opuesto, deberá calentarla.

%%=====================================================================%%
%% NOTA(Pablo): Esto sobra
%%=====================================================================%%
%%
%% Para la situación en la que la temperatura seleccionada por el
%% usuario coincida con la temperatura del lugar donde se encuentra el
%% calefactor, este último no entrará en modo funcionamiento, por lo
%% que no consumirá energía.
%%
%%=====================================================================%%

Esta característica añade clases para representar los nuevos dispositivos, más concretamente, \imp{Thermometer} y \imp{HeaterCtrl}, tal y como se ilustra en la Figura~\ref{domain:fig:heaterMngDesign}. Estos dispositivos extienden las clases abstractas \imp{Actuator} y \imp{Sensor}. Además, se debe extender la clase \imp{Gateway} con nuevos métodos y atributos para el control de estos nuevos dispositivos. A cada aparato de control de la temperatura se le asocia un termómetro en exclusiva, para realizar mediciones mas precisas.

\begin{figure}[!h]
 \centering
 \includegraphics[width=.65\linewidth]{domainEngineering/Images/HeaterMngDesign.eps} \\
 \caption{Diseño UML para la característica \emph{HeaterMng}}
 \label{domain:fig:heaterMngDesign}
\end{figure}

%%=====================================================================%%
%% NOTA(Pablo): Esto es trivial y no merece la pena contarlo
%%=====================================================================%%
%%
%% La principal acción que sostiene esta nueva característica es la de
%% modificar la temperatura de los calefactores por los usuarios del
%% sistema, por ello la figura \ref{domain:fig:secuenciaHeaterMng}
%% ilustra a través de un diagrama de secuencia cuales son los pasos
%% de los mensajes necesarios para que la temperatura sea modificada.
%% Como ya se ha comentado en otras ocasiones en el diagrama de secuencia
%% se vuelve a observar como el Gateway es el mediador que se encarga de
%% transmitir los mensajes entre los distintos dispositivos.
%%
%%
%% \begin{figure}[!tb]
%5 \centering
%%  \includegraphics[width=.75\linewidth]
%%    {domainEngineering/Images/secuenciaHeaterMng.eps}%
%% \\
%% \caption{Diagrama de secuencia para modificar la temperatura.}
%%  \label{domain:fig:secuenciaHeaterMng}
%% \end{figure}
%%
%%=====================================================================%%

También es necesario extender las dos interfaces gráficas que se implementaron en el sistema base. En el caso de la interfaz gráfica para el control del \emph{Gateway}, añadimos una nueva pestaña a nivel global, para toda la casa, que permita encender o apagar todos los aparatos de control de la temperatura. En el caso de que los aparatos estén conectados, se ofrecerá la opción de mostrar la temperatura deseada (ver Figura~\ref{domain:fig:GUIHeaterMng}). Pestañas similares se añaden a todas las plantas y habitaciones que contengan al menos un aparato de control de la temperatura.

\begin{figure}[!tb]
 \centering
 \includegraphics[width=.45\linewidth]{domainEngineering/Images/GUIHeaterMng.eps} \\
 \caption{Interfaz gráfica de usuario con los elementos para el control de temperatura}
 \label{domain:fig:GUIHeaterMng}
\end{figure}

Por otro parte, tembién debemos extender la interfaz gráfica del simulador. Por tanto, añadimos una nueva pestaña que muestre de forma tabular los diferentes aparatos de control de temperatura existentes en la casa así como la información relacionada con los mismos de interés para observar el funcionamiento de la casa (ver Figura \ref{domain:fig:SimulatorHeaterMng}). También se ofrece la posibilidad de cambiar el valor de la variable \emph{Temperatura} de cada termómetro, con objeto de analizar el comportamiento del hogar automatizado en diferentes situaciones.

\begin{figure}[!tb]
 \centering
 \includegraphics[width=.75\linewidth]{domainEngineering/Images/simulatorGUIHeaterMng.eps} \\
 \caption{Diseño de la interfaz gráfica de usuario para el simulador en la característica de \emph{HeaterMng}}
 \label{domain:fig:SimulatorHeaterMng}
\end{figure}

A continuación, tanto el diseño de la Figura~\ref{domain:fig:heaterMngDesign} como el de las interfaces mostradas en las Figuras~\ref{domain:fig:GUIHeaterMng} y~\ref{domain:fig:SimulatorHeaterMng}, se implementa usando los principios descritos en la Sección~\ref{domain:sec:pattern}. Por último, realizamos las pruebas de dicha implementación. Los casos de prueba ejecutados se describen a continuación:

\begin{enumerate}
\item Se han creado una serie de instancias del hogar inteligente con un número de aparatos de control de la temperatura arbitrario y repartidos por distintas habitaciones.
\item Por cada instancia de un hogar concreto se ha verificado que se ejecutan correctamente las siguientes operaciones:
	\begin{enumerate}
		\item Es posible encender, apagar y modificar la temperatura de todos los aparatos de control de la temperatura a través de la interfaz gráfica de usuario. Dicho cambio se refleja además en el simulador.
		%%=====================================================================%%
		%% NOTA(Pablo): Este caso de prueba no lo entiendo                     %%
		%%=====================================================================%%
		%% \item Por cada calefactor se modificará su temperatura para que coincida con la de su termómetro, %% comprobándose que el calefactor cambie su modo de funcionamiento a sin consumo de energía.
		%%=====================================================================%%
		\item Es posible modificar la temperatura de los termómetros, y dicha alteración afecta de forma correcta al modo de funcionamiento de los aparatos de control de la temperatura.
		\item Cuando el usuario modifica la temperatura deseada, los aparatos de frío/calor alteran su funcionamiento de la forma prevista.
	\end{enumerate}
\end{enumerate}


